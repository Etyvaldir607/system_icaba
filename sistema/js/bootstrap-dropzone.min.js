/**
 * Bootstrap-dropzone v0.1
 *
 * Copyright 2019 Wilfredo N.
 */

"use strict";jQuery.fn.extend({dropzone:function(e){var o,a,t,s,r,n,l,i,p,d,c,g,h=["jpg","jpeg","png","bmp","webp","jfif","svg","ico","gif"];i={preview:!0,dropzoneTemplate:'<div class="dropzone"><div class="dropzone-area"></div><div class="dropzone-message"></div><div class="dropzone-preview"></div></div>',parentTemplate:'<div class="row"></div>',childTemplate:'<div class="col"></div>',boxClass:"alert",imageClass:"img-responsive",noneColorClass:"alert-info",dragColorClass:"alert-warning",doneColorClass:"alert-success",failColorClass:"alert-danger",language:{emptyText:"[arrastre los archivos aquí o haga clic para cargar]",dragText:"[suelte los archivos aquí]",dropText:"[_t_ archivos cargados]"},change:function(){}},e=$.extend({},i,e),this.each(function(i){(o=$(this)).after(e.dropzoneTemplate),o.appendTo(o.next().find(".dropzone-area")),(a=$("<div></div>")).attr("class","dropzone-box "+e.boxClass+" "+e.noneColorClass).text(e.language.emptyText),o.before(a),o.on("dragover",function(){$(this).prev().attr("class","dropzone-box "+e.boxClass+" "+e.dragColorClass).text(e.language.dragText)}).on("dragleave drop",function(){s=$(this),p=this.files,s.prev().attr("class","dropzone-box "+e.boxClass+" "+e.noneColorClass).text(p.length>0?e.language.dropText.replace(/_t_/g,p.length):e.language.emptyText),s.trigger("blur")}).on("change",function(){(s=$(this)).trigger("preview"),s.trigger("blur"),e.change.call(this,s,this.files)}).on("preview",function(){s=$(this),t=s.prev(),(r=s.closest(".dropzone").find(".dropzone-preview")).empty(),p=this.files,d=!1,p.length>0?(e.preview&&(n=$(e.parentTemplate),$.each(p,function(o){g=(g=p[o].name.match(/\.[0-9a-z]+$/i))?g[0].split(".").pop().toLowerCase():null,$.inArray(g,h)+1>0&&((c=new FileReader).onload=function(o){l=$('<img src="'+o.target.result+'" class="'+e.imageClass+'">'),l.wrap(e.childTemplate).parent().appendTo(n)},c.readAsDataURL(this),d=!0)}),d&&(n.appendTo(r),r.show())),t.text(e.language.dropText.replace(/_t_/g,p.length))):(r.hide(),t.text(e.language.emptyText))}).on("clear",function(){s=$(this),t=s.prev(),r=s.closest(".dropzone").find(".dropzone-preview"),t.attr("class","dropzone-box "+e.boxClass+" "+e.noneColorClass).text(e.language.emptyText),r.empty(),r.hide()}).on("validation",function(o,a){s=$(this),t=s.prev(),r=s.closest(".dropzone").find(".dropzone-preview"),a?t.attr("class","dropzone-box "+e.boxClass+" "+e.doneColorClass):(t.attr("class","dropzone-box "+e.boxClass+" "+e.failColorClass),r.hide()),s.css("height",t.outerHeight())}),o.closest("form").on("reset",function(){$(this).find(":file").each(function(){$(this).trigger("clear")})})})}});